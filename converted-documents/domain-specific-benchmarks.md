---
title: "Domain Specific Benchmarks"
original_file: "./Domain_Specific_Benchmarks.pdf"
document_type: "research"
conversion_date: "2025-11-29"
topics: ["rag", "evaluation", "multimodal"]
keywords: ["island", "magnetic", "flux", "field", "helical", "section", "point", "width", "equation", "coordinate"]
summary: "<!-- Page 1 -->

4202
luJ
51
]hp-msalp.scisyhp[
2v35480.5042:viXra
Under consideration for publication in J. 1

### Outside and inside a magnetic island:

different perspectives to describe the same
observables
B. Predebon1,2
†
1Consorzio RFX (CNR,ENEA, INFN,Universit`adi Padova, Acciaierie VeneteSpA),Padova,

### Italy

2Istitutoper la Scienza e Tecnologia dei Plasmi - CNR, Padova, Italy
(Received xx;revised xx;accepted xx)
Wecomparethreedifferentapproachestodescribeamagneticislandinagenerictor"
related_documents: []
---

# Domain Specific Benchmarks

<!-- Page 1 -->

4202
luJ
51
]hp-msalp.scisyhp[
2v35480.5042:viXra
Under consideration for publication in J. Plasma Phys. 1

### Outside and inside a magnetic island:

different perspectives to describe the same
observables
B. Momo1 and I. Predebon1,2
†
1Consorzio RFX (CNR,ENEA, INFN,Universit`adi Padova, Acciaierie VeneteSpA),Padova,

### Italy

2Istitutoper la Scienza e Tecnologia dei Plasmi - CNR, Padova, Italy
(Received xx;revised xx;accepted xx)
Wecomparethreedifferentapproachestodescribeamagneticislandinagenerictoroidal
plasma: (i) perturbative, from the perspective of the equilibrium magnetic field and the
relatedactioninavariationalprincipleformulation,(ii)againperturbative,basedonthe
integrability of a system with a single resonant mode and the application of a canonical
transformationontoanewislandequilibriumsystem,and(iii)non-perturbative,making
use of a full geometric description of the island considered as a stand-alone plasma
domain. For the three approaches, we characterize some observables and discuss the
respective limits.

## Introduction

The tearing instability, growing near the rational surfaces, leads to helical magnetic
perturbations that can change the magnetic topology, with the formation of magnetic
islands through a reconnection process in which the field lines break and reconnect.
Especially for the description of magnetic field line trajectories, it is convenient to
express the magnetic field in terms of its vector potential. In this way, the magnetic
field line equations can be derived from a variational principle, formally identical to
the action principle in phase space with a Hamiltonian H (Cary & Littlejohn 1983;
Elsasser 1986; Hazeltine & Meiss 1992). The magnetic field line equations are the path
that extremize the action S , and are formally identical to the canonical equations of
γ
motion in phase space. The identification of canonical and magnetic variables follows
the paperby Pina & Ortiz (1988): the symmetry coordinate(e.g.the toroidalangleϕin
an axisymmetric magnetic field) is identified with the time t, another space coordinate
(the poloidal angle ϑ) plays the role of the canonical position q, whereas the poloidal
and toroidal magnetic fluxes, ψ and ψ , have their equivalence in the Hamiltonian H
p t
and canonicalmomentum p, respectively (when the symmetry coordinate is the toroidal
one). Hidden in these identifications is the additional equivalence between the covariant
components A of the vector potential and the magnetic fields, that follows from Stokes
i
theorem. A pedagogical presentation of the above elements is available in the recent
review paper by Escande & Momo (2024).
FollowingtheHamiltonianformulationofthemagneticfieldlineequations,inthiswork
we compare three different methods to characterize a magnetic island in terms of some
observables (e.g., the island width or its volume) which cannot depend on a particular
coordinate system, vector potential gauge, or choice of perturbative/nonperturbative
approach.Thefirsttwomethodsconsidertheislandasasingle-modeperturbationofthe
† Email address for correspondence: italo.predebon@igi.cnr.it

<!-- Page 2 -->

2
equilibrium Hamiltonian and provide a description of the observables, say, from outside
the island; conversely, the other method considers the island as a stand-alone plasma
subdomain with a self-consistent representation of the observables from its inside.
With the first perturbative approach, we consider an (m,n) tearing mode (where m
and n are the poloidal and the toroidal mode number, respectively) at the resonant
surface where the island opens, defined by the rational value ι = n/m of the rotational
transformprofile.Weapplyanewformulationfortheislandwidthbasedonthedefinition
of the actionS ofthe magnetic systemthat returns the same resultas the island width
γ
estimated from the amplitude of the eye-of-cut of a pendulum Hamiltonian in phase
space (Escande & Momo 2024). The width classicallydepends on a flux Φ relatedto the
radial magnetic perturbation at the rational surface (White 2013; Park et al. 2008). In
Escande & Momo (2024) this flux is identified – with a clear geometrical meaning and
independently ofthe coordinatesystem – asthe flux throughthe ribbonenclosedby the
orbits of the O-point and the X-point of the island. In this work we extend its validity
even to non-perturbative contexts, showing that it can be interpreted as the helical flux
through the island separatrix,independently of the approach adopted.
In the second method, we exploit the integrability of the Hamiltonian of a perturbed
system that preserves the helical symmetry, defining the island domain as a new equilibrium with its ownmagnetic axis correspondingto the O-pointof the island.Magnetic
coordinates aredefined on the islandflux surfacesas canonicalaction-anglecoordinates,
providingadefinitionofmagneticfluxesthroughtheislandfluxsurfaces,aswellasother
quantitiesliketheislandvolumeandwidth(Martines et al.2011;Momo et al.2011).The
transition from a perturbed Hamiltonian to a new equilibrium Hamiltonian represents
the change of perspective claimed in the title of the paper, moving from the view of
an axisymmetric equilibrium with an external magnetic axis with respect to the island
(perspectivefromoutsidetheisland)totheislanddomainitselfwithitsownaction-angle
coordinates (perspective from inside the island).
Inthethird,non-perturbativeapproach,theislanddomainisconsideredindependently
of the surrounding plasma. It is geometrically characterized in terms of magnetic coordinates and metric tensor starting from a discretized field map, again providing integral
quantities like the magnetic fluxes,the island volume and width, which are,in principle,
measurable (Predebon et al. 2018).
The three methods are compared for the calculation of several observables of two
experimental islands, (1,1) for a circular tokamak and (1,7) for a reversed-field pinch
(RFP)plasma.The agreementissatisfactory.Inparticular,thecomparisonofthe island
width provides a first validation of the formula introduced by Escande & Momo (2024)
in a perturbative context, and shows the validity of the new interpretation of the flux
Φ (hereafter Φ ) as the helical flux through the island separatrix,particularly relevant

## Ox

when the island is characterizedin non-perturbative contexts.
The paper is structured as follows:the two perturbative approaches are introduced in
section 2 and 3, and the non-perturbative approachin section 4; in the following section
5 we compare the three methods for a (1,1) tokamak island and a (1,7) reversed-field
pinch(RFP)islandinatoroidaldevicewithcircularcross-section,withabriefsummary
closing the paper.

## Magnetic islands in a perturbative approach

Magnetic islands are due to non-vanishing resonant magnetic perturbations in the
plasma,andaperturbativeapproachisthereforefrequentlyusedfortheirdescription.In
particular,amagneticislandwithpoloidalmandtoroidalnperiodicityopensaroundthe

<!-- Page 3 -->

3
Figure 1. Helical ribbon definingthe ΦOX flux for a (1,1) magnetic island, with in black and
red the closed orbits corresponding to theO- and the X-point,respectively.
resonant flux surface defined by the rational value ι = n/m of the rotational transform
related to the unperturbed equilibrium configuration.
The island width is commonly computed in terms of the geometric width of a
pendulum-like eye-of-cat in the context of small resonant perturbations of a regular
magnetic field, associated to a time-independent Hamiltonian (Hazeltine & Meiss 1992;
White 2013). In all cases, the width of a magnetic island results proportional to the
square root of a magnetic flux, which turns out to be the perturbation of a helical
flux evaluated on the resonant flux surface (Park et al. 2008; Predebon et al. 2016). As
showninsection3,thisfluxcanbeinterpretedasthehelicalfluxthroughtheseparatrix.
In this section we exploit the existence of a coordinate-independent magnetic
flux related to a magnetic island that correctly estimates its width, as proved in
Escande & Momo (2024): this flux, named Φ , is defined for each magnetic island

## Ox

throughtheribbondefinedbytheperiodicorbitsrelatedtotheOandXpointsshownin
figure 1. The above path is based on the variational principle formulation for magnetic
field lines and on the related action
S = A(x) dx (2.1)
γ

## Z ·

γ
where x is the spatialcoordinatesvector,A is the vectorpotential, B= A, andthe
∇×
integral runs along the path γ between two points of a magnetic field line. When γ is a
closed circuit,Stokes theorem states that the actionS is the magnetic flux throughthe
γ
surface having this circuit as a boundary.
In orderto relatethe actionS to the resonantperturbationthatopens anisland,the
γ
formal identification between canonical and magnetic coordinates, and the equivalence
between the covariant components A , i = 1,2,3 (where the index i corresponds e.g. to
i
the radial,poloidalandtoroidalcoordinate,respectively)ofthe vectorpotentialandthe
magnetic fluxes must be used in the definition of S . This equivalence is only valid in
γ

<!-- Page 4 -->

4
the axial gauge A =0,
1
S = (A dx2+A dx3)
γ 2 3

## Z

γ
1
= (pdϑ Hdϕ)
2π Z −
γ
1
= (ψ dϑ ψ dϕ) (2.2)
t p
2π Z −
γ
with x2 = ϑ and x3 = ϕ poloidal and toroidal angles; the relations p = ψ and H = ψ
t p
definetheidentificationsbetweenthecanonicalmomentumandthetoroidalmagneticflux
andbetweenthe Hamiltonianandthe poloidalflux,respectively,assumingthe canonical
position and time to be: q =x2 =ϑ and t=x3 =ϕ.
Figure 1 visualizes the helical ribbon defined by the orbits of the O and X points and
helpsunderstandthegeometricalmeaningofthefluxΦ throughthatribbon.Usingthe

## Ox

definition of the action for a magnetic field line, the Φ flux turns out to be S S ,

## Ox O X

−
where S is the action computed along the closed orbit defined by the O point, and

## O

S the action along the closed orbit defined by the X point. In the rest of this section

## X

we revisit the derivation of section 5 of the review Escande & Momo (2024) writing the
island width as a function of Φ .

## Ox

Let x = (ψ0,ϑ,ϕ) be magnetic coordinates for the unperturbed equilibrium. If the
t
perturbation is not large enough to violate the requirement of a non-null Jacobian,then
the full perturbedsystemaroundthe resonantsurface,in the same x coordinatesystem,
is approximated by
ψ (x) ψ0+ψm,n(ψ0)eiu+c.c. (2.3)
t ≃ t t t
ψ (x) ψ0+ψm,n(ψ0)eiu+c.c. (2.4)
p ≃ p p t
whereu=mϑ nϕiscalledhelicalangleandc.c.indicatesthecomplexconjugation.The
−
unperturbedflux,ψ0 =ψ0(ψ0),definestheunperturbedequilibriumanditsfluxsurfaces
p p t
throughtherelationι=dψ0/dψ0 =dϑ/dϕ.Theψm,n(ψ0)= ψm,n eiαm,n termsarethe
p t t | |
Fourier components of the fluxes having the resonant periodicity.
WenowbetterdefinetheactionsS andS ,whicharethelineintegralsalongthelines

## O X

defined by the O and X-point of the (m,n) magnetic island, respectively. In calculating
S and S fromequation(2.2) using definitions (2.3)-(2.4) we assume that m and n are

## O X

mutually relativelyprime; ϕ varies by 2πm along O or X and ϑ varies by 2πn, while the
helical angles along the O and X orbits (u and u respectively) are constant.

## O X

We first compute the action S :

## O

1
S = (ψ dϑ ψ dϕ) (2.5)

### O t p

2π Z −

## O

=(nψ0 mψ0) +(nψm,n mψm,n) eiuO +c.c.
t − p | res t − p | res
where all radialfunctions must be evaluatedonthe rationalsurface defined by ι=n/m,
evenifnotexplicitlystatedinthefollowingnotation.Introducingthehelicalfluxfunction
ψ (ψ0,u)=mψ nψ , (2.6)
h t p − t
S can be written in terms of this flux through the O-point orbit as

## O

S =ψ (ψ0,u )
− O h t O
=ψ h 0 + | ψ h m,n | ei(uO+αm h ,n)+c.c. (2.7)

<!-- Page 5 -->

5
where ψ0 = ψ0(ψ0) is the unperturbed equilibrium flux, whereas ψm,n and αm,n are
h h t | h | h
the amplitude and phase of the (m,n) Fourier component.
The calculation of the S flux follows the same steps, with u being substituted by

## X O

u , and remembering that u is shifted by π with respect to u : u +αm,n =0,π and

### X X O O h

u +αm,n =π,0, depending on the sign of the magnetic shear. This yields:

### X h

S (ψ0)=ψ0+2 ψm,n cos(u +αm,n)
− O t h | h | O h
=ψ0 2 ψm,n (2.8)
h± | h |
S (ψ0)=ψ0+2 ψm,n cos(u +αm,n)
− X t h | h | X h
=ψ0 2 ψm,n (2.9)
h∓ | h |
Φ S S = 4 ψm,n (2.10)

### OX ≡ O − X ∓ | h |

with all radial functions evaluated on the rational surface. The minus sign in equation
(2.10) corresponds to a negative magnetic shear at the rational surface (dι/dψ0 < 0),
t
which implies u +αm,n = 0, while the positive sign corresponds to the opposite case

### O h

(dι/dψ0 >0), with u +αm,n =π.
t O h
From an operative point of view, the Φ flux can be computed both from equation

## Ox

(2.10),orsolvingnumericallythelineintegralsinequation(2.2)forγ =Oandγ =X.In
the first case one needs to evaluate the helical flux perturbation at the resonantsurface;
in the second case, one needs to know the path of the island extrema.
Theamplitude ofthe magneticislandcanthenbecomputedfromtheformula(similar
to equation (90) of Escande & Momo (2024))
Φ dr

## Ox


## W


## Φox

=4v
u u t (cid:12) (cid:12) (cid:12) 2m d d ψ ι t 0 (cid:12) (cid:12) (cid:12) (cid:18)dψ t 0(cid:19)
, (2.11)
(cid:12) (cid:12)
where the factor (dψ0/dr)−1 brings the (cid:12)width in(cid:12) units of a lengths. It implies a clear
t
relation between the unperturbed flux ψ0 and a radial coordinate r in meters: when r
t
is the radius of circular flux surfaces cross-section of the zeroth-order equilibrium, the
factor (dψ0/dr)−1 considers the same amplitude at any poloidal or toroidal cuts. All
t
radial functions, as the magnetic shear or the (dψ0/dr)−1 term, must be evaluated at
t
the resonant surfaces.

## Magnetic islands as new equilibrium systems

Insection2westatedtheequivalencebetweenthemagneticactionalongahelicalpath
γ and the helical flux. From this perspective, equations (2.8)-(2.9) can be written in a
shorter notation:
S =ψ (3.1)
O h O
− |
S =ψ (3.2)
X h X
− |
and therefore
Φ S S = ψ +ψ (3.3)
OX O X h O h X
≡ − − | |
where ψ means the helical flux evaluated along the line defined by the O-point, and
h O
|
similarly ψ . From a geometrical point of view, S can be interpreted as the helical
h X O
|
flux ψ through the the surface delimited by the orbit of the center of the island (O
h O
|
point), whereas S as the helical flux ψ through the edge of the island (the orbit
X h X
|
defined by the X point). In this section, as well as in section 4, a way to compute the
magnetic fluxes through any island flux surface is shown.

<!-- Page 6 -->

6
Figure 2. Top. ϕ = 0 discretized field map of a (1,7) island (top half of the section) and
correspondingfluxsurfacecontour(bottomhalf)inacircularRFP.Redandlight-bluecurvesin
thehalftoppanelrepresentthetwolastfluxsurfacesfromtheFlitcode(Innocenteet al.2017),
thethicklineinthebottomhalfpaneltheseparatrixcomputedbytheSheqcode(Martines et al.
2011), and coloured dots the X (orange) and O (green) points. Bottom: the helical flux ψ on
h
the equatorial plane passing through theX (orange) and O (green) points.
The perturbative approach in section 2 assumes an integrable unperturbed magnetic
fieldconfiguration,i.e.,theequationofmotioncanbesolvedtogivenon-chaoticmagnetic
fieldlinesandthereforeconservedmagneticfluxsurfaces.Inpresenceofgeneralmagnetic
perturbations the system is not integrable, and flux surfaces are destroyed. Apart from
an axisymmentric system, there is only one other known integrable system, i.e. that of
helicalsymmetry,thatdefinesconservedmagneticfluxsurfaces,analogoustotheconstant
energysurfaces.Inbothcases,theHamiltonianistime-independent,andtheequivalence
t=ϕ holds.
Equations (2.3)-(2.4), adding to the unperturbed equilibrium a single Fourier perturbation, define a helical integrable Hamiltonian. To integrate it, we make use of the
change of coordinates(ψ0,ϑ,ϕ) (ψ0,u,ϕ), where u=mϑ nϕ is the helicalvariable.
t 7→ t −
This changeof coordinatesdefines a new time-independent Hamiltonian: the helicalflux
ψ (ψ0,u)=mψ nψ ,thatcanbeassumedasradialvariableofanysystemwithahelical
h t p − t
symmetry (Hazeltine & Meiss 1992). In fact, in the new coordinates, the identifications
with the (p,q,t) variables are: q =x2 =u, t=x3 =ϕ and therefore p=ψ , H =ψ .
t h
The islanddomaincanbe modeledasahelicalequilibriumconfiguration,andarecon-

<!-- Page 7 -->

7
structionofsuchequilibriahasbeenimplementedinacodenamedSHEq(Martines et al.
2011), now extended to the tokamak case too. The method is based on the superposition of an axisymmetric equilibrium and of a first-order helical perturbation computed
according to Newcomb’s equation supplemented with edge magnetic field measurements
(Zanca & Terranova 2004); more details are in section 5. The helical flux contours give
the shape of the flux surfaces of a helical domain. An example of such surfaces is shown
in figure 2 (bottom half of the top panel) for a magnetic island in a RFP plasma. The
accuracyofthe flux surfacereconstructionis confirmedby the correspondingdiscretized
field map (top half) obtained with the field line tracing code Flit, which integrates
the field lines with the same helical Fourier perturbations (Innocente et al. 2017). The
value of helical flux through the surfaces delimited by the X and O point orbits (their
intersection with the poloidal plane respectively plotted in figure with an orange and
greendot)canbe identifiedfromthevalue ofthe helicalfluxatthe extremaofitsprofile
on the equatorial plane (figure 2, bottom panel). The values of the helical flux above
the value at the separatrix (orange dashed line in figure 2 bottom) label the external
flux surfaces with respect to the magnetic island, so the helical flux profile computed
by the SHEq code is here cutted at the separatrix to restrict the computation to the
island domain. The values of ψ in the well between the X and the O point correspond
h
to the island flux surfaces; whereas the values of ψ in the other well correspond to the
h
circular flux surfaces around the axisymmetric equilibrium axis. It is worth noting that
the evaluationofthehelicalfluxonthe XandOpointspermitstoevaluatetheΦ flux

## Ox

from equation (3.3), and therefore the island width from equation (2.11).
We can now define a new reference frame having its axis on the O-point of the island.
From here on we introduce the new index to explicitly identify the quantities related

## H

·
to the helical magnetic flux surfaces Σ from the O-point to the separatrix. A time-

## H

independent canonical change of coordinates allows us to write the Hamiltonian of the
helical system, ψ , in its action-angle form, ψ , where both the poloidal and toroidal
h H
fluxesacrossthehelicalfluxsurfacesareconstantsofthemotion(Momo et al.2011)and
therefore functions ofψ . Due to the time-independence of the canonicaltranformation,

## H

ψ and ψ define the same flux surfaces. Using the definition of the canonical action
h H
coordinate, the identifications between canonical and magnetic coordinates, and the
perturbed fluxes in equations (2.3)-(2.4), the toroidal flux through Σ is defined by:

## H

1
ψ (ψ )= p(E,q)dq =I(E) (3.4)
Ht H
2π I
1
= ψ (ψ ,u)du. (3.5)
t h
2π I

## Σh

Equation (3.4) is the standard formula for the canonical action coordinate, usually
indicated with the symbol I(E) for a givenenergy value E, andq the canonicalposition
(Arnol’d2013).Inequation(3.5)theidentificationswithcanonicalcoordinateshavebeen
used,the constantenergyvalue E correspondingto the constantvalue ofψ onΣ ,and
h H
the expression(2.6) for the helicalflux has been invertedto obtain ψ (ψ ,u).It is worth
t h
noting that on the right hand side of this equation the perturbed quantities appear, as
ψ and ψ , while on the left hand side we have the quantities through the island flux
t h
surfaces,identifiedby .Asasideremark,the actioncoordinateinequation(3.4)isnot

## H

·
related to the magnetic action in equation (2.1). The angle coordinate, defined on the

<!-- Page 8 -->

8
helical axis, is defined by (Arnol’d 2013)
q ∂p(I,q ′ )
′
u = dq (3.6)

## H


## Z ∂I

q0
u ∂ψ (ψ ,u′)
t H ′
= du , (3.7)

### Z 0 ∂ψ Ht

thatturnsouttobethestraight-helical-likeangledefinedonthehelicalaxis(theO-point
of the island) which increases by 2π one turn around every helical flux surface.
Equation(3.5)impliesthatbothmagneticfluxes(theactionψ andtheHamiltonian

### Ht

ψ ofthesystem)areconstantofthemotion,i.e.areconstantonmagneticfluxsurfaces.

## H

Moreover, magnetic field lines written in the action-angle coordinates are straight lines
in the (u ,ϕ) plane. The definitions of a helical angle and of a helical flux,

## H

u =mϑ nϕ (3.8)

## H H

−
ψ =mψ nψ , (3.9)
H Hp Ht
−
bring to the definition of the new poloidal-like angle ϑ defined on the island O point

## H

and, implicitly, of the poloidal flux through Σ , ψ =(ψ +nψ )/m. The rotational

### H Hp H Ht

transform related to straight-field-lines in the plane (ϑ ,ϕ) is defined by

## H

dϑ dψ

### H Hp

ι = = (3.10)

## H

dϕ dψ

### Ht

which counts the poloidal and toroidal turns of an island magnetic field line seen by an
external observer. Moreover, the Jacobian and the metric elements of the (ψ ,ϑ ,ϕ)

## H H

coordinate system allow us to calculate any geometric quantity related to the island
domain, as the island volume, using the procedure that will be described in the next
section for the stand-alone coordinate system.
We remark that the helical fluxes, ψ (ψ0,u) and ψ (ψ ) in equations (2.6) and
h t H Ht
(3.9), respectively, are the same flux, due to the fact that the coordinate transformation
(ψ0,u,ϕ) (ψ ,ϑ ,ϕ) is equivalent to a time-independent canonical transformation,
t 7→ H H
that does not change the Hamiltonian of the system. They differ just by the value of
ψ (ψ0,u) on the helical axis, which ensures that ψ , ψ and ψ vanish there:
h t H Ht Hp
ψ =ψ (ψ0,u) ψ (3.11)

### H h t − h | O

being ψ = ψ (ψ0,u) , whereas ψ = 0. Equation (3.11), together with equations
h | O h t | O H | O
(3.1) and (3.2) for S and S , permits the interpretationof Φ (which is the magnetic

## O X Ox

flux through the ribbon given by the O and X point orbits, as depicted in figure 1) as
the helical flux through the separatrix surface. In fact,
S =ψ (3.12)
O h O
− |
S =ψ =ψ +ψ (3.13)
X h X h O H X
− | | |
simply yield
Φ =S S = ψ . (3.14)

## Ox O X H X

− − |
Note that these considerations also apply to the next section.

## Magnetic islands as stand-alone domains

Magneticislands,evenifembeddedinaglobaltoroidalmagneticfield,canberegarded
as separated plasma domains. In a previous work (Predebon et al. 2018) we described a

<!-- Page 9 -->

9
0.2
0.1
0.0
0.1
−
0.2
−
1.8 1.9 2.0 2.1 2.2
R[m]
]m[Z
Figure 3. ϕ = 0 discretized field map of a (1,1) island in a circular tokamak (top half of the
section)andcorrespondingflux-coordinategrid(bottomhalf)withtheρI=constlines(inblue,
thick for ρI=1) and theϑI =kπ/8, k integer lines (in purple,thick for ϑI=0,π).
method to characterize geometrically every isolated domain from discretized field maps.
Thesemapsareusuallytheoutcomeofafield-linetracingcodeoranMHDcode:starting
from a set of points in the usual cylindrical coordinates (R,Z,ϕ) – with R the distance
fromtheaxisofthetorus,Z thedistancefromtheequatorialplane,andϕthegeometrical
toroidal angle – the method allows to obtain a magnetic coordinate system (ψ ,ϑ ,ϕ)

### It I

in the island, with the following expression for the magnetic field B,
1
B= ( ψ ϑ +ι (ψ ) ϕ ψ ), (4.1)
It I I It It
2π ∇ ×∇ ∇ ×∇
where ι (ψ ) = dψ /dψ is the rotational transform inside the island, ϕ the toroidal

### I It Ip It

angle,andϑ the poloidalanglesuchthatthefieldlinesarestraightonthe(ϑ ,ϕ)plane,

## I I

with dϑ /dϕ=ι (ψ ). As ϕ is the geometrictoroidalangle,these coordinatesare called

### I I It

symmetry flux coordinates (D’haeseleer et al. 1991). We remark that the (ψ ,ϑ ,ϕ)

### It I

and (ψ ,ϑ ,ϕ) systems, being flux coordinates sharing the same toroidal angle, are

### Ht H

mathematically equivalent. The indexes and denote the different procedure used to

## I H

· ·
generate the respective flux coordinate systems.
Due to the high curvature of the surfaces in the proximity of the X-point, the method
developedby Predebon et al. (2018) does notallow to getan accuratedescriptionofthe
geometry in that region, thus we limit our reconstruction to the surface immediately
preceding the separatrix. This is assumed to be the boundary of our domain.
There is freedom in the choice of the radial coordinate. Once a normalized radial
coordinate ρ is defined such that ρ = 0 on the magnetic axis and ρ = 1 on the last

## I I I

closedmagneticsurfaceofthedomain,andtheJacobianmatrixd(R,Z,ϕ)/d(ρ ,ϑ ,ϕ),or

## I I

equivalently d(x,y,z)/d(ρ ,ϑ ,ϕ), is known,we cancalculate the (inverse)metric tensor

## I I

gij = xi xj and the Jacobian J = √g, which for the coordinates (ρ

## I

,ϑ

## I

,ϕ) will be
∇ ·∇
explicitly written as J .

## I

Being the metric tensor well defined in the whole island domain, we introduce here
the observables that we intend to compare with the other approaches. Let us consider
the width of the island itself. This can be measured with the ruler or can be calculated
using the metric tensor. At a given toroidal angle ϕ = ϕ¯, for a fixed the poloidal angle

<!-- Page 10 -->

10
ϑ =ϑ¯, the (curvilinear)distance coveredalong the ρ direction from the magnetic axis

## I I I

to a generic surface with ρ 61 is

## I

ρI
L |(ϑ¯ I,ϕ¯) (ρ I )= Z g ρ 1 I / ρ 2 I (ρ I ′ ,ϑ¯ I ,ϕ¯)dρ I ′ , (4.2)
0
where we have used the infinitesimal line element expression dl2 =g dxidxj restricted
ij
to the radial direction. In figure 3, we show the ϕ = 0 section of a (1,1) island in a
circular tokamak based on the RFX-mod geometry, obtained again with the field line
tracing code Flit. At this section the ϑ = 0 and ϑ = π coordinate lines correspond to

## I I

the horizontal cut of the island, so that the island width is simply given by

## W =L (1)+L (1) (4.3)

I ϕ¯=0 (0,0) (π,0)
| | |
Other useful quantities for a comparison with the other approaches include the volume
enclosed by the surface with radius ρ

## I

′
V (ρ )= J dρ dϑ dϕ, (4.4)

## I I I I I


### Z [0,ρI]×[0,2π]×[0,2π]

as well as the poloidal(the ribbon poloidalflux, as is called in D’haeseleer et al. (1991))
flux
1
ψ (ρ )= BϑIJ dρ ′ dϑ dϕ, (4.5)

### Ip I I I I

2π Z [0,ρI]×[0,2π]×[0,2π]
and the toroidal flux
1
ψ (ρ )= BϕJ dρ ′ dϑ dϕ (4.6)

### It I I I I

2π Z [0,ρI]×[0,2π]×[0,2π]
wherethepoloidalandtoroidalcontravariantcomponentsofthefieldaregivenbyBϑI =
B ϑ and Bϕ =B ϕ, respectively.

## I

·∇ ·∇
Combining equations (4.5)-(4.6) to define the helical flux ψ = mψ nψ , the
IH Ip It
−
island width can be again inferred from equations (2.11) with Φ = ψ , as in

## Ox Ih X

− |
equation(3.14), since the helicalflux onthe islandaxis vanishes identically.In this case,
the Φ flux is calculated at ρ = 1, not at the separatrix, as a line integral following

## Ox I

one of the tips of the island, which is the curve that best approximates the separatrix,
corresponding to the angle u =mϑ nϕ= π/2.

## I I

− ±

## A comparison of the different approaches

In the following, we provide a comparison of some observables using the different approachesdescribedabove.Forthiscomparison,weconsidertheislandsalreadyintroduced
inthe previoussections,namelya(1,1)islandinacirculartokamakanda(1,7)islandin
the RFP, both based on RFX-mod, a circular toroidal device with major radius R =2
0
m and minor radius a = 0.46 m which can perform operation in either configuration
(Sonato et al. 2003).
The reconstruction of the magnetic island topology is based on the calculation of
the helical perturbations to the zeroth-order equilibrium. According to the procedure
developed by Zanca & Terranova (2004), this is done solving a Newcomb-like equation,
i.e. the linearized force-balance equation with the linearized Ampere’s law ensuring a
divergence-free magnetic field, using the external magnetic measurements as boundary
conditions. Due to the set of measurements available in RFX-mod (48 toroidal arraysof
4 poloidally equispacedprobes for both the radialand toroidalfield components), a rich

<!-- Page 11 -->

11
0.04
0.02
0.00
]2mT[
tψ
tokamak(1,1) RFP(1,7)
0.08
0.04
0.00
1.00
0.98
0.96
ι
7.4
7.2
7.0
1.0
0.5
0.0
0.00 0.02 0.04
ψp [Tm2]
]3m[

## V

0.8
0.4
0.0
0.00 0.25 0.50
ψp [Tm2]
Figure 4.Toroidalflux(toppanels),ι(midpanels),andvolume(bottompanels)asafunction
of the poloidal flux for a (1,1) tokamak island (left column) and a (1,7) RFP island (right
column), for theapproaches of section 3 (red lines) and section 4 (black).
island surface VH[m3]† ψHt [Tm2]† ψHp [Tm2]† VI[m3]‡ ψIt [Tm2]‡ ψIp [Tm2]‡
ρI=1 0.806 3.49×10−2 3.38×10−2 0.813 3.50×10−2 3.40×10−2
tok(1,1) separ. 1.237 4.50×10−2 4.39×10−2 – – –
ρI=1 0.673 6.61×10−2 4.83×10−1 0.676 6.63×10−2 4.83×10−1
RFP(1,7) separ. 0.925 8.58×10−2 6.25×10−1 – – –
ΦOX[Tm2]† W

## Φox

[cm]† ΦOX[Tm2]‡ W

## Φox

[cm]‡ ΦOX[Tm2]◦ W

## Φox

[cm]◦
ρI=1 1.12×10−3 9.96 1.02×10−3 9.49 – –
tok(1,1) separ. 1.34×10−3 10.86 – – 1.35×10−3 10.93
ρI=1 2.05×10−2 12.01 1.90×10−2 11.57 – –
RFP(1,7) separ. 2.40×10−2 13.01 – – 2.40×10−2 13.12
WI| ϕ¯=0[cm]‡ Wr| ϕ¯=0[cm]
ρI=1 9.45 9.45
tok(1,1)
separ. – 10.07
ρI=1 10.99 10.97

## Rfp(1,7)

separ. – 11.86
Table 1. For a (1,1) tokamak island and a (1,7) RFP island, ·† quantities refer to the
perturbative method of section 3, ·‡ quantities to the non-perturbative method of section 4,
·◦ quantities to the perturbative method of section 2; in the second row W is calculated

## Φox

from ΦOX by means of equation (2.11) for the 3 different methods: ΦOX † = mψHp −nψHt ,
ΦOX ‡ = mψIp −nψIt , ΦOX ◦ as defined in equation (2.10). WI| ϕ¯=0 is the width as defined in
equation (4.3). Wr| ϕ¯=0 is thewidth measured with theruler at ϕ=0.

<!-- Page 12 -->

12
spectrumofFouriercomponentscanbereconstructedforthe magneticperturbations.In
this work we focus on the dominant resonant Fourier component generating the (m,n)
island, as specified in equations (2.3)-(2.4). The mode is (m,n)=(1,1) for the tokamak
case, pulse 38818 at t=362 ms, and (m,n) = (1,7) for the RFP case, which is the
averaged discharge described in Momo et al. (2020). The resulting islands have been
characterized geometrically in Predebon et al. (2018), where the discretized field maps
have been produced by the field line tracing code Flit (Innocente et al. 2017) which is
indeed based on the Newcomb’s perturbed fluxes as input.
As already mentioned, the comparison with the stand-alone approach of section 4 is
possible only within the surface ρ =1, which for both the RFP and tokamak islands is

## I

the last surface of the Poincar´e section before the separatrix. For the other approaches
the radial domain extends from the O-point of the island to the separatrix.
In figure 4 and table 1 we summarize the results of the comparison. In the figure, the
toroidal flux, the rotational transform and the volume profiles are plotted as a function
of the poloidal flux for the approaches of section 3 (red lines) and section 4 (black).
In particular, the poloidal and toroidal fluxes and the rotational transform defining the
island flux surfaces are computed from equations (3.5) and (3.10) in the approach of
section 3, and from equations (4.5)-(4.6) in the approach of section 4. The volume is
computed in both cases from the definition (4.4), using the related coordinate system
and Jacobian. The comparison can be considered satisfactory. The small difference in
the recontruction of the rotational transform profile (around 0.4% at the surface ρ =1

## I

for the tokamak,0.5%for the RFP), explains the pointwise differences inthe fluxes that
appear in the following table.
For the two islands, in the table we review the most relevant quantities calculated at
the X-point and at the last surface at the Poincar´e map (ρ = 1). For the perturbative

## I

method of section 3 applied to the ρ = 1 surface, we assume ψ = ψ and
I Hp
|
ρI=1 Ip
|
ρI=1
derivethe otherquantitiesbasedonthis referencevalue.The islandvolume,the toroidal
and poloidal fluxes through the island are reported in the first block of the table. In the
secondblock,theΦ fluxiscomputedfromequation(2.10)fortheapproachofsection2,

## Ox

asthehelicalfluxthroughtheseparatrixusingequation(3.14)fortheapproachofsection
3, and as the path integral along the (best approximation of the) X-point identified by
the angle u = mϑ nϕ = π/2 in the geometric approach of section 4 (proving also

## I I

− ±
that Φ = S when the fluxes vanish on the O-point). Then, for the 3 methods, the

## Ox X

−
related island width is calculated with equation (2.11). To complete the table, we also
report the island width as resulting from equation (4.3) and as measured with a ruler
from the Poincar´emaps at ϕ=0, W .
r ϕ¯=0
|
The method which best estimates W is that of section 4, which is not surprising
r ϕ¯=0
|
astheislandgeometryisdirectlyderivedfromthePoincar´emapitself:theW width
I ϕ¯=0
|
from equation (4.3) perfectly matches W . From the Φ flux calculated as path
r ϕ¯=0 OX
|
integral along one of the tips of the island, we provide the width W from equation

## Φox

(2.11),whichyieldsavaluewithin1%and5%errorwithrespecttoW ,fortokamak
r ϕ¯=0
|
and RFP respectively.
Ontheotherhand,theperturbativemethodsofsections2and3overestimatethetotal
island width, within 6% and 10% error with respect to W , for tokamak and RFP
r ϕ¯=0
|
caserespectively.We recallthattheformulaofequation(2.11)forW comesfromthe

## Φox

formalanalogybetweenthetypicaltext-bookdeformationofthefluxsurfacesaroundthe
resonanceduetotheopeningofamagneticislandandthephasediagramofapendulum,
validforsmallperturbations.Thisexplainstheerrorintroducedbytheapplicationofthis
formula to the specific cases shown here, where the perturbation cannot be considered
small. Large perturbations cause a displacement of the O-point and X-point from the

<!-- Page 13 -->

13
rational surface where the radial derivatives are calculated. However, the correction to
Φ whencalculatedasthe helicalfluxthroughthe islandseparatrix(methodofsection

## Ox

3),withrespecttoitsestimatebasedontheaxisymmetricequilibrium(methodofsection
2), slightly improves the evaluation of the width.

## Summary

We have considered three different approaches for a geometric characterization of
magnetic islands, (i) the first one perturbative, (ii) the second one perturbative but
leading to the definition of a new single-helicity equilibrium, (iii) the third one nonperturbative based on the availability of a discretized field map.
InthefirstperturbativemethodtheislandisdescribedinaHamiltoniancontextusing
the definition of action S of a magnetic system. The novelty of this approach, first
γ
introduced by Escande & Momo (2024), is the definition of a coordinate-independent
flux with a clear geometrical meaning – here named Φ – related to the island width

## Ox

through equation (2.11). This formula, coming from the analogy between a textbook
magnetic island and the eye-of-cut shape of the phase diagram of a pendulum, is very
similartotheclassicalformulasfortheislandwidth(Hazeltine & Meiss1992;Park et al.
2008), but with a new meaning of the flux that appears in all other formulations. The
secondmethod,developedbyMartines et al.(2011)andMomo et al.(2011)fortheRFP
equilibrium and here extended to the tokamak configuration,starts from a perturbative
approach that sums the zeroth-order equilibrium and the single resonant perturbation
generating the island, then leading to the definition of a new single-helicity equilibrium
usingdefinitionsspecifictoHamiltonianmechanics.Thethird,non-perturbativemethod,
is based on the availability of a discretized field map and defines the island domain
through its geometrical definitions, as first developed by Predebon et al. (2018).
A detailed comparison has been carried out among the three methods applying them
to two experimental islands of RFX-mod, both tokamak and RFP. We have provided
an estimate of some observables showing that they are, in general, in good agreement
among each other. As a novelty, moreover, we have extended the use of the expression
(2.11)forthe islandwidth ina broadercontextthanthe perturbativeapproachinwhich
it was first developed, thanks to a more comprehensive geometric interpretation of the
Φ flux. In particular, the Φ flux, originally defined as the flux through the ribbon

## Ox Ox

defined by the O and X point orbits, is identified as the helical flux through the island
separatrix.
Asafinalremark,the(third)non-perturbativemethod,strictlybasedonthegeometry
of the flux surfaces, is the one which provides the most accurate description of the
island observables for a large part of the island domain, failing, however, to describe
the separatrix due to the high curvature of the flux surfaces in the neighborhood of
the X-point. This approach applies to any isolated region of the plasma, without any
assumptions on the symmetry of the system and the possible interactions with other
perturbations withdifferent helicities.Onthe other hand,the twoperturbativemethods
provide a geometric characterization which is in reasonable agreement with the nonperturbativemethod,atleastinthecaseswithastronghelicalsymmetry.Easiertoapply,
based as they are on a single-mode perturbation from a linear Newcomb-like analysis,
thesemethodscansatisfactorilyhighlightthemostrelevantfeaturesofanislandwithout
theneedtobuilddiscretizedfieldmapsand/oruseMHDcodes,providingaviablemethod
for a fast description of a magnetic island domain.

<!-- Page 14 -->

14

### Acknowledgements

WearegratefultoD.F.EscandeandP.Zancaforreadingthemanuscriptandproviding
useful observations.

## References

Arnol’d, V. I. 2013 Mathematical methods of classical mechanics, , vol. 60. Springer Science
& Business Media.
Cary, J. R. & Littlejohn, R. G. 1983 Noncanonical Hamiltonian mechanics and its
application to magnetic field line flow. Annals of Physics 151 (1), 1–34.
D’haeseleer, W. D., Hitchon, W. N. G., Callen, J. D. & Shohet, J. L. 1991 Flux
Coordinates and Magnetic Field Structure: A Guide to a Fundamental Tool of Plasma
Theory. Berlin Heidelberg: Springer-Verlag.
Elsasser, K. 1986 Magnetic field line flow as a Hamiltonian problem. Plasma physics and
controlled fusion 28 (12A), 1743.
Escande, D. & Momo, B.2024Description ofmagneticfieldlineswithout arcana.Reviews of
Modern Plasma Physics 8(16).
Hazeltine, R. D. & Meiss, J. D. 1992 Plasma Confinement. Vol. 86.
Innocente, P., Lorenzini, R., Terranova, D. & Zanca, P. 2017 FLiT: a field line trace
code for magnetic confinement devices. Plasma Physics and Controlled Fusion 59 (4),
045014.
Martines, E., Lorenzini, R., Momo, B., Terranova, D., Zanca, P., Alfier, A.,
Bonomo, F., Canton,A.,Fassina, A.,Franz,P. &Innocente,P.2011Equilibrium
reconstruction for single helical axis reversed field pinch plasmas. Plasma Phys. Control
Fusion 53 (035015), 19pp.
Momo, B., Isliker, H., Cavazzana, R., Zuin, M., Cordaro, L., Bruna, D. L.,
Martines, E., Predebon, I., Rea, C., Spolaore, M., Vlahos, L. & Zanca, P.
2020 Thephenomenology ofreconnection eventsinthereversedfieldpinch.Nucl. Fusion
60 (056023), 15pp.
Momo, B., Martines, E., Escande, D. & Gobbin, M. 2011 Magnetic coordinate systems
for helical SHAx states in reversed field pinch plasmas. Plasma Phys. Control Fusion
53 (125004), 13pp.
Park, J., Boozer, A. H. & Menard, J. E. 2008 Spectral asymmetry due to magnetic
coordinates. Physics of Plasmas 15 (6), 064501.
Pina, E. & Ortiz, T. 1988 On Hamiltonian formulations of magnetic field line equations.
Journal of Physics A: Mathematical and General 21 (5), 1293.
Predebon,I.,Momo,B.,Suzuki,Y.&Auriemma,F.2018Reconstructionoffluxcoordinates
from discretized magnetic field maps. Plasma Phys. Control. Fusion 60 (4), 045003.
Predebon, I., Momo, B., Terranova, D. & Innocente, P. 2016 MHD spectra and
coordinate transformations in toroidal systems. Physics of Plasmas 23 (9), 092508.
Sonato, P., Chitarin, G., Zaccaria, P., Gnesotto, F., Ortolani, S., Buffa, A.,
Bagatin, M., Baker, W., Dal Bello, S., Fiorentin, P., Grando, L., Marchiori,
G., Marcuzzi, D., Masiello, A., Peruzzo, S., Pomaro, N. & Serianni, G. 2003
Machine modification for active MHD control in RFX. Fusion Engineering and Design
66-68, 161–168.
White, R. B. 2013 The Theory Of Toroidally Confined Plasmas (Third Edition). World
ScientificPublishing Company.
Zanca, P. & Terranova, D. 2004 Reconstruction of themagnetic perturbation in a toroidal
reversed field pinch.Plasma Phys. Control Fusion 46, 1115–1141.

## Tables

**Table (Page 9):**

| 0.2 0.1 ]m[Z 0.0 0.1 − 0.2 − 1.8 1.9 2.0 2.1 2.2 R[m] |  |
|---|---|
|  |  |


**Table (Page 11):**

|  |  |  |
|---|---|---|
|  |  |  |


**Table (Page 11):**

|  |  |  |
|---|---|---|
|  |  |  |
